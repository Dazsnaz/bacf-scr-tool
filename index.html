<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BACF OCC Slot Tool v25</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap');
        
        body { font-family: 'Montserrat', sans-serif; transition: background 0.3s ease; }
        .mono { font-family: 'JetBrains+Mono', monospace; }
        .ba-blue { background-color: #002366; }
        .ba-red { background-color: #D6001C; }
        .ba-stripe { height: 4px; background: linear-gradient(90deg, #002366 0%, #002366 75%, #D6001C 75%, #D6001C 100%); }

        body.dark-mode { background-color: #0f172a; }
        .dark-mode .bg-white { background-color: #1e293b; color: #f1f5f9; border-color: #334155; }
        .dark-mode input, .dark-mode select { background-color: #0f172a; color: white; border-color: #334155; }
        
        @media print { .no-print { display: none !important; } .bg-slate-900 { background: white !important; color: black !important; border: 1px solid #ccc !important; } textarea { color: black !important; } }
    </style>
</head>
<body class="bg-slate-200 p-4 md:p-8" id="mainBody">
    <div class="max-w-6xl mx-auto bg-white rounded-xl shadow-2xl overflow-hidden border border-slate-300">
        
        <div class="ba-blue p-6 relative no-print">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <div class="w-1 ba-red h-12"></div>
                    <div>
                        <h1 class="text-white text-3xl font-black tracking-tighter italic uppercase">BACF OCC</h1>
                        <p class="text-blue-200 text-[11px] font-bold uppercase tracking-widest">Final Master Release v25.0</p>
                    </div>
                </div>
                <div class="flex gap-4">
                    <button onclick="toggleDarkMode()" class="text-xs font-bold text-white border border-white/20 px-3 py-1 rounded hover:bg-white/10 transition">NIGHT MODE</button>
                    <button onclick="window.print()" class="ba-red text-white text-xs font-bold px-3 py-1 rounded shadow-lg hover:bg-red-700 transition">PRINT</button>
                </div>
            </div>
        </div>
        <div class="ba-stripe no-print"></div>

        <div class="p-8">
            <div class="grid grid-cols-1 md:grid-cols-6 gap-4 mb-8 no-print items-end">
                <div>
                    <label class="block text-[10px] font-black text-slate-500 mb-2 uppercase tracking-widest">Flight No.</label>
                    <input list="flightList" id="flightInput" oninput="handleSearch()" placeholder="3270" class="w-full border-b-2 border-slate-300 p-3 bg-slate-50 font-black text-xl outline-none">
                    <datalist id="flightList"></datalist>
                </div>
                <div class="w-20">
                    <label class="block text-[10px] font-black text-slate-500 mb-2 uppercase tracking-widest">Suffix</label>
                    <input type="text" id="suffix" maxlength="1" oninput="generateSCR()" placeholder="-" class="w-full border-b-2 border-slate-300 p-3 bg-slate-50 font-black text-xl outline-none uppercase text-blue-600">
                </div>
                <div class="md:col-span-1">
                    <label class="block text-[10px] font-black text-slate-500 mb-2 uppercase tracking-widest">Route <button onclick="swapRoute()" class="text-blue-600 hover:text-red-600 ml-1 underline uppercase">Swap</button></label>
                    <div class="flex gap-1">
                        <input type="text" id="manualDep" oninput="generateSCR()" placeholder="DEP" class="w-1/2 border-b-2 border-slate-300 p-3 bg-slate-50 uppercase font-bold outline-none">
                        <input type="text" id="manualArr" oninput="generateSCR()" placeholder="ARR" class="w-1/2 border-b-2 border-slate-300 p-3 bg-slate-50 uppercase font-bold outline-none">
                    </div>
                </div>
                <div>
                    <label class="block text-[10px] font-black text-slate-500 mb-2 uppercase">Reason (SI)</label>
                    <select id="delayReason" onchange="generateSCR()" class="w-full border-b-2 border-slate-300 p-3 bg-slate-50 font-bold text-xs outline-none">
                        <option value="REQUEST">REQUEST</option><option value="TECH">TECH</option><option value="CREW">CREW</option><option value="ATC">ATC</option><option value="ROT">ROT</option><option value="WX">WX</option>
                    </select>
                </div>
                <div>
                    <label class="block text-[10px] font-black text-slate-500 mb-2 uppercase">Action</label>
                    <select id="action" onchange="toggleChangeUI()" class="w-full border-b-2 border-blue-800 p-3 font-black text-blue-900 bg-blue-50 outline-none">
                        <option value="N">NEW (N)</option><option value="D">DELETE (D)</option><option value="CR">CHANGE (C/R)</option>
                    </select>
                </div>
                <div>
                    <button onclick="resetConsole()" class="w-full border-2 border-slate-200 p-3 rounded-lg text-slate-400 font-bold text-[10px] hover:bg-slate-100 hover:text-red-600 transition">CLEAR ALL</button>
                </div>
            </div>

            <div id="shiftPanel" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 bg-slate-900 p-6 rounded shadow-inner border-t-4 border-red-600 no-print">
                <div class="md:col-span-2 grid grid-cols-2 gap-4 border-r border-slate-700 pr-4">
                    <div class="col-span-2 mb-2"><label class="block text-[9px] font-bold text-slate-400 mb-1 uppercase tracking-widest">Original Date (C)</label><input type="date" id="opDate" onchange="generateSCR()" class="w-full bg-slate-800 border border-slate-700 p-2 text-white font-bold text-sm outline-none"></div>
                    <div><label class="block text-[9px] font-bold text-slate-400 mb-1 uppercase tracking-widest">Orig DEP</label><input type="text" id="depSlot" value="1200" oninput="generateSCR()" class="w-full bg-slate-800 border border-slate-700 p-3 text-white font-mono text-xl outline-none"></div>
                    <div><label class="block text-[9px] font-bold text-slate-400 mb-1 uppercase tracking-widest">Orig ARR</label><input type="text" id="arrSlot" value="1400" oninput="generateSCR()" class="w-full bg-slate-800 border border-slate-700 p-3 text-white font-mono text-xl outline-none"></div>
                </div>
                <div class="md:col-span-2 grid grid-cols-2 gap-4 pl-2">
                    <div id="newDateDiv" class="hidden col-span-2 mb-2"><label class="block text-[9px] font-bold text-blue-400 mb-1 uppercase tracking-tighter">New Date (R)</label><input type="date" id="newOpDate" onchange="generateSCR()" class="w-full bg-slate-800 border-2 border-blue-800 p-2 text-white font-bold text-sm outline-none"></div>
                    <div id="newDepDiv" class="hidden"><label class="block text-[9px] font-bold text-blue-400 mb-1 uppercase tracking-widest">New DEP</label><input type="text" id="newDepSlot" value="1215" oninput="generateSCR()" class="w-full bg-slate-800 border-2 border-blue-800 p-3 text-white font-mono text-xl outline-none"></div>
                    <div id="newArrDiv" class="hidden"><label class="block text-[9px] font-bold text-blue-400 mb-1 uppercase tracking-widest">New ARR</label><input type="text" id="newArrSlot" value="1415" oninput="generateSCR()" class="w-full bg-slate-800 border-2 border-blue-800 p-3 text-white font-mono text-xl outline-none"></div>
                </div>
            </div>

            <div id="outputContainer" class="grid grid-cols-1 md:grid-cols-2 gap-8"></div>
        </div>
    </div>

    <script>
        const ukIreland = ["LHR","LGW","LCY","STN","SEN","EDI","GLA","ABZ","MAN","BFS","BHD","DUB","ORK","SNN"];
        const flightNumbers = ["2212","2213","2216","2217","2222","2223","2280","2281","2282","2283","2284","2285","2286","2287","2550","2551","2552","2553","2554","2555","2570","2571","2572","2573","2574","2575","2576","2577","2578","2579","2584","2585","2588","2589","2590","2591","2594","2595","2596","2597","2604","2605","2606","2607","2608","2609","2610","2611","2612","2613","2614","2615","2616","2617","2620","2621","2622","2623","2624","2625","2626","2627","2640","2641","2642","2643","2644","2645","2650","2651","2654","2655","2656","2657","2660","2661","2662","2663","2664","2665","2666","2667","2668","2669","2670","2671","2672","2673","2676","2677","2678","2679","2680","2681","2682","2683","2684","2685","2700","2701","2702","2703","2704","2705","2706","2707","2708","2709","2710","2711","2712","2713","2716","2717","2720","2721","2722","2723","2748","2749","2750","2751","2752","2753","2754","2755","2756","2757","2758","2759","2778","2779","2780","2781","2784","2785","2790","2791","2794","2795","2808","2809","2810","2811","2812","2813","2814","2815","2816","2817","2818","2819","2907","3270","3271","3272","3273","3274","3275","3278","3279","3280","3299","4450","4451","4452","4453","4454","4455","4456","4457","4458","4459","4460","4461","4462","4463","4464","4465","4466","4467","4468","4469","4470","4471","4472","4473","4514","4515","4516","4535","4536","4541","4542","7016","7017","7018","7019","7021","7022","7026","7027","7033","7034","7301","7302","7303","7304","7305","7306","7308","7309","7316","7317","7334","7335","7348","7349","8450","8451","8452","8453","8454","8455","8456","8457","8458","8459","8460","8461","8462","8463","8464","8470","8471","8472","8474","8475","8476","8477","8478","8479","8480","8481","8482","8483","8484","8487","8488","8489","8490","8491","8492","8493","8494","8495","8496","8497","8550","8551","8620","8621","8624","8625","8626","8627","8628","8629","8630","8631","8632","8633","8634","8635","8700","8701","8702","8703","8704","8705","8706","8707","8708","8709","8710","8711","8713","8714","8715","8716","8718","8719","8720","8721","8722","8723","8724","8725","8726","8727","8728","8729","8730","8734","8735","8737","8738","8739","8741","8742","8745","8746","8751","8752","8753","8756","8757","8758","8761","8762","8763","8764","8765","8766","8767","8768","9795","9796","9997"];
        const list = document.getElementById('flightList');
        flightNumbers.forEach(n => { const o = document.createElement('option'); o.value = n; list.appendChild(o); });
        document.getElementById('opDate').valueAsDate = new Date();
        document.getElementById('newOpDate').valueAsDate = new Date();
        let depDesigMan = null, arrDesigMan = null;

        function resetConsole() {
            document.getElementById('flightInput').value = '';
            document.getElementById('suffix').value = '';
            document.getElementById('manualDep').value = '';
            document.getElementById('manualArr').value = '';
            document.getElementById('depSlot').value = '1200';
            document.getElementById('arrSlot').value = '1400';
            document.getElementById('outputContainer').innerHTML = '';
            depDesigMan = null; arrDesigMan = null;
        }

        function swapRoute() {
            const d = document.getElementById('manualDep').value, a = document.getElementById('manualArr').value;
            document.getElementById('manualDep').value = a; document.getElementById('manualArr').value = d;
            generateSCR();
        }

        function toggleDarkMode() { document.getElementById('mainBody').classList.toggle('dark-mode'); }
        function cycleDesig(c) { const s = ["BA", "CJ", "A0"]; return s[(s.indexOf(c) + 1) % 3]; }
        function toggleDep() { const c = document.getElementById('depDesignatorSpan').innerText; depDesigMan = cycleDesig(c); generateSCR(); }
        function toggleArr() { const c = document.getElementById('arrDesignatorSpan').innerText; arrDesigMan = cycleDesig(c); generateSCR(); }

        function handleSearch() {
            const v = document.getElementById('flightInput').value;
            depDesigMan = null; arrDesigMan = null;
            document.getElementById('manualDep').value = v.startsWith("2") ? "LGW" : "LCY";
            document.getElementById('manualArr').value = "XXX";
            generateSCR();
        }

        function toggleChangeUI() {
            const isCR = document.getElementById('action').value === 'CR';
            document.getElementById('newDepDiv').classList.toggle('hidden', !isCR);
            document.getElementById('newArrDiv').classList.toggle('hidden', !isCR);
            document.getElementById('newDateDiv').classList.toggle('hidden', !isCR);
            generateSCR();
        }

        function getAutoDesig(num, apt) {
            if (num.startsWith("2")) return ukIreland.includes(apt) ? "BA" : "A0";
            return (ukIreland.includes(apt) || apt === "AMS") ? "BA" : "CJ";
        }

        function generateSCR() {
            const container = document.getElementById('outputContainer'); container.innerHTML = '';
            const num = document.getElementById('flightInput').value;
            const suff = document.getElementById('suffix').value.toUpperCase();
            if (!num) return;
            const depApt = document.getElementById('manualDep').value.toUpperCase();
            const arrApt = document.getElementById('manualArr').value.toUpperCase();
            const action = document.getElementById('action').value;
            const reason = document.getElementById('delayReason').value;
            const acft = num.startsWith("2") ? "177320" : "106E90";
            const oD = new Date(document.getElementById('opDate').value);
            const nD = new Date(document.getElementById('newOpDate').value);
            const oDmmm = oD.getDate().toString().padStart(2, '0') + ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][oD.getMonth()];
            const nDmmm = nD.getDate().toString().padStart(2, '0') + ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][nD.getMonth()];
            const oDow = (d => { let s = ["0","0","0","0","0","0","0"]; let i = d.getDay() === 0 ? 7 : d.getDay(); s[i-1] = i.toString(); return s.join(""); })(oD);
            const nDow = (d => { let s = ["0","0","0","0","0","0","0"]; let i = d.getDay() === 0 ? 7 : d.getDay(); s[i-1] = i.toString(); return s.join(""); })(nD);
            const season = (oD.getMonth() < 3 || oD.getMonth() > 9) ? "W25" : "S26";
            const configs = [
                {t: `${depApt} DEP`, apt: depApt, tgt: arrApt, oT: document.getElementById('depSlot').value, nT: document.getElementById('newDepSlot').value, sid: 'depDesignatorSpan', func: 'toggleDep()', desig: depDesigMan || getAutoDesig(num, arrApt)},
                {t: `${arrApt} ARR`, apt: arrApt, tgt: depApt, oT: document.getElementById('arrSlot').value, nT: document.getElementById('newArrSlot').value, sid: 'arrDesignatorSpan', func: 'toggleArr()', desig: arrDesigMan || getAutoDesig(num, depApt)}
            ];
            configs.forEach(b => {
                let msg = `SCR\n/bacityflyer.ops@ba.com\n${season}\n${oDmmm}\n${b.apt}\n`;
                const isD = b.t.includes('DEP');
                if(action === 'CR') {
                    msg += `C${b.desig}${num} ${oDmmm}${oDmmm} ${oDow} ${acft} ${isD ? b.oT+b.tgt : b.tgt+b.oT} J\n`;
                    msg += `R${b.desig}${num}${suff} ${nDmmm}${nDmmm} ${nDow} ${acft} ${isD ? b.nT+b.tgt : b.tgt+b.nT} J\n`;
                } else {
                    msg += `${action}${b.desig}${num}${suff} ${oDmmm}${oDmmm} ${oDow} ${acft} ${isD ? b.oT+b.tgt : b.tgt+b.oT} J\n`;
                }
                msg += `SI ${reason}\nGI BRGDS BACF OPS`;
                renderBox(container, b.t, msg, b.desig, b.func, b.sid);
            });
        }

        function renderBox(p, t, txt, desig, func, sid) {
            const d = document.createElement('div');
            d.className = "bg-slate-900 rounded border-l-4 border-blue-800 p-6 shadow-xl relative transition-all hover:border-red-600";
            d.innerHTML = `
                <div class="flex justify-between mb-4 border-b border-slate-700 pb-2 no-print">
                    <button onclick="${func}" class="text-white text-[10px] font-black uppercase tracking-widest bg-blue-800 px-2 py-1 hover:bg-red-600 transition">${t} (<span id="${sid}">${desig}</span>)</button>
                    <button onclick="navigator.clipboard.writeText(this.parentElement.nextElementSibling.value); this.innerText='COPIED'" class="text-slate-500 hover:text-white text-[10px] font-bold uppercase transition-all">Copy</button>
                </div>
                <textarea readonly class="w-full h-44 bg-transparent text-green-400 mono text-sm outline-none resize-none leading-relaxed overflow-hidden">${txt}</textarea>`;
            p.appendChild(d);
        }
    </script>
</body>
</html>
